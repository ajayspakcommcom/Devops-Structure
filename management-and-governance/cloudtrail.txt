
AWS CloudTrail – Key Pointers

    1. What is CloudTrail?
        . A service that records all API calls and user activity in your AWS account.
        . Captures activity from:
            . AWS Management Console
            . AWS CLI
            . AWS SDKs
            . AWS services calling each other
        . Essential for auditing, compliance, and security investigations.


    2. Why Use It?
        . Provides a detailed history of actions taken in AWS.
            . Critical for:
            . Security investigations (who did what, when, from where).
            . Compliance audits (PCI DSS, HIPAA, SOX, ISO).
            . Troubleshooting misconfigurations or failed changes.

    3. Core Features
        . Event Recording: Captures management events (config changes) and data events (access to S3, Lambda).
        . Event History: View past 90 days of events in console (free).
        . Trails: Deliver logs to S3 + CloudWatch for long-term storage & analysis.
        . CloudTrail Lake: Query logs with SQL (serverless).
        . Integration: Works with GuardDuty, Security Hub, CloudWatch, EventBridge.

    4. Security
        . Logs encrypted at rest (KMS).
        . IAM policies control access to trails.
        . Logs stored in S3 → can enable Object Lock for tamper-proof storage.
        . Detect suspicious activity (e.g., DeleteBucket, ChangeIAMPolicy).

    5. Cost Model
        . Free: 90-day event history (management events).
        . Paid:
            . Trails delivered to S3 → charged for S3 storage + $2 per 100,000 events for data events.
            . CloudTrail Lake queries billed per TB scanned.

    6. Industry Standards & Best Practices
    ✅ . Enable CloudTrail in all regions (multi-region trails).
    ✅ . Store logs in S3 with encryption + lifecycle policies.
    ✅ . Enable CloudTrail Insights to detect unusual activity (e.g., sudden API spikes).
    ✅ . Integrate with GuardDuty + Security Hub for threat detection.
    ✅ . Use CloudWatch/EventBridge rules for real-time alerts (e.g., root login detected).
    ✅ . Enable Organization Trails with AWS Organizations for enterprise-wide auditing.

    7. Typical Corporate Use Cases
       . Financial services → audit IAM and API changes.
       . Healthcare → compliance reporting for HIPAA.
       . E-commerce → track changes to S3 buckets (public access attempts).
       . Government → forensic investigations after incidents.
       . DevOps → troubleshoot failed deployments by checking API history.

    8. Summary
        . AWS CloudTrail = audit log service for all AWS API activity.
            . Provides event history, trails, CloudTrail Lake, Insights.
            . Industry best practices → enable org-wide, store logs in S3, integrate with GuardDuty/Security Hub, set alerts on critical API actions.